<!--
  ~ Copyright 2015 OpenCB
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~     http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  -->

<link rel="import" href="components/shared/cellbase-species-menu.html">
<link rel="import" href="components/core/cellbase-genomic-panel.html">
<link rel="import" href="components/core/cellbase-gene-panel.html">
<link rel="import" href="components/core/cellbase-regulation-panel.html">
<link rel="import" href="components/variation/cellbase-variation-panel.html">
<link rel="import" href="components/variation/cellbase-clinical-panel.html">
<link rel="import" href="components/variation/cellbase-variantannotation-panel.html">

<dom-module id="cellbase-web">

    <template>
        <style is="custom-style" include="jso-styles"></style>
        <style>
            .center {
                margin: auto;
                width: 98%;
            }
        </style>

        <div>
            <div style="height: 60px;">
                <nav class="navbar navbar-inverse navbar-fixed-top">
                    <div class="container-fluid">
                        <!-- Brand and toggle get grouped for better mobile display -->
                        <div class="navbar-header cellbase-menu">
                            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
                                <span class="sr-only">Toggle navigation</span>
                                <span class="icon-bar"></span>
                                <span class="icon-bar"></span>
                                <span class="icon-bar"></span>
                            </button>
                            <a class="navbar-brand" href="#home">CellBase Data Portal</a>
                        </div>

                        <!-- Collect the nav links, forms, and other content for toggling -->
                        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                            <ul class="nav navbar-nav">
                                <li class="dropdown cellbase-menu">
                                    <a href="#home"><span class="glyphicon glyphicon-home" aria-hidden="true"></span></a>
                                </li>

                                <li class="dropdown">
                                    <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Core <span class="caret"></span></a>

                                    <ul class="dropdown-menu cellbase-menu">
                                        <li><a href="#genomicPanel">Genomic Region</a></li>
                                        <li><a href="#genePanel">Gene/Transcript</a></li>
                                        <!--<li><a href="#transcriptPanel">Transcript</a></li>-->
                                        <!--<li><a href="#proteinPanel">Protein</a></li>-->
                                        <li><a href="#regulationPanel">Regulation</a></li>
                                        <!--<li><a href="#xrefsPanel">XRefs</a></li>-->
                                    </ul>
                                </li>

                                <li class="dropdown">
                                    <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Variation <span class="caret"></span></a>
                                    <ul class="dropdown-menu cellbase-menu">
                                        <li><a href="#variationPanel">Variation (SNV)</a></li>
                                        <li><a href="#clinicalPanel">Clinical</a></li>
                                        <li role="separator" class="divider"></li>
                                        <li><a href="#variationAnnotationPanel">Variant Annotation</a></li>
                                    </ul>
                                </li>

                                <!--<li class="dropdown">-->
                                    <!--<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Networks <span class="caret"></span></a>-->
                                    <!--<ul class="dropdown-menu cellbase-menu">-->
                                        <!--<li><a href="#ppiPanel">Protein Protein Interaction</a></li>-->
                                    <!--</ul>-->
                                <!--</li>-->

                                <li class="dropdown">
                                    <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Visualization <span class="caret"></span></a>
                                    <ul class="dropdown-menu cellbase-menu">
                                        <li><a href="#genomeMap">Genome Browser (Genome Maps)</a></li>
                                        <!--<li><a href="#cellMap">Network viewer (Cell Maps)</a></li>-->
                                    </ul>
                                </li>
                            </ul>

                            <!-- Controls aligned to the right: version, species, search, settings and about-->
                            <ul class="nav navbar-nav navbar-right">
                                <!--<li class="dropdown">-->
                                    <!--<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Version <span class="caret"></span></a>-->
                                    <!--<ul class="dropdown-menu">-->
                                        <!--<li><a href="#">v3</a></li>-->
                                        <!--<li><a href="#">v4</a></li>-->
                                    <!--</ul>-->
                                <!--</li>-->

                                <div class="navbar-form navbar-left" style="padding-top: 7px">
                                    <cellbase-species-menu cellbase-client={{cellbaseClient}}></cellbase-species-menu>
                                </div>

                                <form class="navbar-form navbar-left" role="search">
                                    <div class="form-group">
                                        <input type="text" class="form-control" placeholder="BRCA2,rs666,3:4444-6666">
                                        <a href="#">
                                            <span class="glyphicon glyphicon-search" aria-hidden="true"></span>
                                        </a>
                                    </div>
                                    <!--<button type="submit" class="btn btn-default">Submit</button>-->
                                </form>

                                <li>
                                    <a href="#" data-toggle="modal" role="button" data-placement="bottom" data-target="#myModal" title="Settings ...">
                                        <i class="fa fa-cog"></i>
                                        <!--<span class="glyphicon glyphicon-cog" aria-hidden="true"></span>-->
                                    </a>
                                </li>

                                <li class="dropdown">
                                    <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
                                    <ul class="dropdown-menu">
                                        <li><a href="https://github.com/opencb/cellbase/wiki/About" target="_blank">About</a></li>
                                        <li><a href="https://github.com/opencb/cellbase" target="_blank">GitHub</a></li>
                                        <li><a href="https://github.com/opencb/cellbase/wiki" target="_blank">Documentation</a></li>
                                        <li><a href="#">Contact</a></li>
                                        <li><a href="#">FAQ</a></li>
                                    </ul>
                                </li>
                            </ul>
                        </div><!-- /.navbar-collapse -->
                    </div><!-- /.container-fluid -->
                </nav>
            </div>

            <!-- This is where main application is rendered -->
            <div class="center">
                <div class="collapse content" id="home" style="width: 60%; text-align: justify; margin-left: 20%;">
                    <div style="text-align: center">
                        <br>
                        <span style="font-size:50px;">Welcome to CellBase data portal tool!</span>
                        <br>
                        <br>
                        <div style="font-size: 14px; text-align: justify">
                            <p>
                                CellBase is a scalable and high-performance NoSQL database that integrates relevantbiological information from well-known data sources such as
                                Ensembl, Uniprot, IntAct or ClinVar among others. All this data can be queried through acomprehensive RESTful web services API.This tool allows
                                to query CellBase data through web interface thus making it easier and also serves as avisualization tool.
                            </p>

                        </div>
                        <br>
                        <br>
                        <input type="text" class="form-control" id="welcomeSearchTextBox" style="text-align: center;"
                               placeholder="Search for a gene, transcript, variant, multi-allelic variant or region">
                        <p>Example: BRCA2, ENST00000342992, rs666, 10:15097577:G:C, 3:4444-6666</p>

                    </div>

                    <div class="col-sm-12"><br><br>Note:
                        <span style="font-size:13px">
                            <br> CellBase web application makes an intensive use of the HTML5 standard and other cutting-edge web technologies such as Web Components,
                            so only modern web browsers are fully supported, these include Chrome 36+, Firefox 32+, IE 10+, Safari 7+ and Opera 24+.
                        </span>
                    </div>
                </div>
                <div class="collapse content" id="genomicPanel">
                    <h2>Genomic Region</h2>
                    <cellbase-genomic-panel cellbase-client={{cellbaseClient}} cellbase="http://bioinfo.hpc.cam.ac.uk/cellbase"></cellbase-genomic-panel>
                </div>
                <div class="collapse content" id="genePanel">
                    <h2>Gene/Transcript</h2>
                    <cellbase-gene-panel cellbase-client={{cellbaseClient}} cellbase="http://bioinfo.hpc.cam.ac.uk/cellbase"></cellbase-gene-panel>
                </div>
                <!--<div class="collapse content" id="transcriptPanel">-->
                    <!--Transcript-->
                <!--</div>-->
                <!--<div class="collapse content" id="proteinPanel">-->
                    <!--NOT YET READY FOR BETA VERSION-->
                <!--</div>-->
                <div class="collapse content" id="regulationPanel">
                    <h2>Regulation</h2>
                    <cellbase-regulation-panel cellbase-client={{cellbaseClient}} cellbase="http://bioinfo.hpc.cam.ac.uk/cellbase"></cellbase-regulation-panel>
                </div>
                <!--<div class="collapse content" id="xrefsPanel">-->
                    <!--NOT YET READY FOR BETA VERSION-->
                <!--</div>-->
                <div class="collapse content" id="variationPanel">
                    <h2>Variation</h2>
                    <cellbase-variation-panel cellbase-client="{{cellbaseClient}}" population-frequencies="{{populationFrequencies}}"
                                              protein-substitution-scores="{{proteinSubstitutionScores}}" consequence-types="{{consequenceTypes}}"></cellbase-variation-panel>
                </div>
                <div class="collapse content" id="clinicalPanel">
                    <h2>Clinical Data</h2>
                    <cellbase-clinical-panel cellbase-client={{cellbaseClient}} cellbase="http://bioinfo.hpc.cam.ac.uk/cellbase"></cellbase-clinical-panel>
                </div>
                <div class="collapse content" id="variationAnnotationPanel">
                    <h2>Variant Annotation</h2>
                    <cellbase-variantannotation-panel cellbase-client={{cellbaseClient}} cellbase="http://bioinfo.hpc.cam.ac.uk/cellbase"></cellbase-variantannotation-panel>
                </div>
                <!--<div class="collapse content" id="ppiPanel">-->
                    <!--NOT YET READY FOR BETA VERSION-->
                <!--</div>-->
                <div class="collapse content" id="genomeMap">
                    Genome browser goes here
                </div>
                <!--<div class="collapse content" id="cellMap">-->
                    <!--NOT YET READY FOR BETA VERSION-->
                <!--</div>-->
            </div>

        </div>



        <!-- Modal dialog for Settings -->
        <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="myModalLabel">Settings</h4>
                    </div>
                    <div class="modal-body">
                        <div class="form-group row">
                            <label for="cellbaseHost" class="col-sm-2 col-form-label">Hosts</label>
                            <div class="col-sm-10">
                                <input type="text" class="form-control" id="cellbaseHost" value="bioinfo.hpc.cam.ac.uk/cellbase, www.ebi.ac.uk/cellbase">
                            </div>
                        </div>
                        <div class="form-group row">
                            <label for="cellbaseVersion" class="col-sm-2 col-form-label">Version</label>
                            <div class="col-sm-2">
                                <select name="version" class="form-control" id="cellbaseVersion">
                                    <option>v3</option>
                                    <option selected>v4</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                        <button type="button" class="btn btn-primary">OK</button>
                    </div>
                </div>
            </div>
        </div>

    </template>

    <script>
        Polymer({
            is: 'cellbase-web',
            properties: {
                cellbaseClient: {
                    type: Object
                },
                hosts: {
                    type: String,
                    value: "http://bioinfo.hpc.cam.ac.uk/cellbase"
                },
                versions: {
                    type: String
                }
            },
            ready: function () {
                this.cellBaseClientConfig = new CellBaseClientConfig(hosts = cellbase.hosts, version = cellbase.version, species = cellbase.species);
                this.cellbaseClient = new CellBaseClient(this.cellBaseClientConfig);

                if (typeof populationFrequencies !== "undefined") {
                    this.populationFrequencies = populationFrequencies;
                }

                if (typeof proteinSubstitutionScores !== "undefined") {
                    this.proteinSubstitutionScores = proteinSubstitutionScores;
                }

                if (typeof consequenceTypes !== "undefined") {
                    this.consequenceTypes = consequenceTypes;
                }

                $(".cellbase-menu a").on('click', function(e) {
                    e.preventDefault(); // stops link form loading
                    $('.content').hide(); // hides all content divs
                    $( $(this).attr('href') ).show(); //get the href and use it find which div to show
                });
                $('#home').show();
            }
        });
    </script>
</dom-module>
